/*1346856218,173217321*/

if (window.CavalryLogger) { CavalryLogger.start_js(["xBfEu"]); }

function PluginConfigurator(){}copyProperties(PluginConfigurator.prototype,{init:function(a,b){this.config=a;this.config.code_button=b;for(var c in this.config.params)this.config.params[c].value=this.config.params[c]['default'];var d=$(this.config.form_id),e=DOM.scry(d,'input');e=e.concat(DOM.scry(d,'textarea'));for(var f in this.config.params){var g=0;if(this.config.params[f].type=='question'){var h='param_'+f+'_link',i=f+'_link',j=ge(h);this.config.params[i]={};this.config.params[i].lastShownPollItem=1;this.config.params[i].questionName=f;for(var k=0,l=e.length;k<l;k++)if(e[k].name==f+"poll"+g){g++;this.config.params[e[k].name]={};this.config.params[e[k].name].pollName=f;this.config.params[e[k].name].type='poll';this.config.params[e[k].name].value=this.config.params[f]['default'];}this.config.params[f].questionsCount=g-1;Event.listen(j,'click',this.handleAddLinkClick.bind(this));}}for(var k=0,l=e.length;k<l;k++){this.updateFormElement(e[k]);Event.listen(e[k],'change',this.handleChange.bind(this));}var m=DOM.scry(d,'div.uiSelector');for(var n=0,o=m.length;n<o;n++){this.updateFormElement(m[n]);Selector.listen(m[n],'change',this.handleSelectorChange.bind(this));}this.renderExample();},renderExample:function(){var a=[],b='',c={},d=false,e=[],f;for(var g in this.config.params){var h=this.config.params[g],i=h.value,j=h['default'],k=h.example,l=h.always_set,m=h.type;if(i===undefined&&k!==undefined)i=k;if(h.xfbml_name)g=h.xfbml_name;if(m=='question')f=g;if(m=='poll')e.push(i);if(g=='colorscheme'&&i=='dark')d=true;if(i!==undefined&&i!==''&&m!='question'&&m!='poll'&&(l!=null||i!=j||i==k)){g='data-'+g.replace(/_/g,'-');c[g]=i;}}if(e.length!==0)c[f]=JSON.stringify(e);b=DOM.create('div');for(var n in c)if(c.hasOwnProperty(n))b.setAttribute(n,c[n]);b.className=this.config.xfbml.replace(':','-');if(!this.config.example_id)return;var o=$(this.config.example_id),p=["fb:activity","fb:comments","fb:facepile","fb:like","fb:like-box","fb:recommendations","fb:subscribe"];if(p.contains(this.config.xfbml))CSS.conditionClass(b,'dark_background',d);DOM.setContent(o,b);FB.XFBML.parse(o);},handleAddLinkClick:function(event){var a=event.getTarget(),b=this.getName(a)||this.getName(a.parentNode),c=this.config.params[b].lastShownPollItem,d=this.config.params[b].questionName;c++;var e=ge('param_'+d+c);if(e!=null){e.type="text";this.config.params[b].lastShownPollItem=c;var f=ge('param_'+d+(c+1));if(f==null){a.parentNode.style.visibility='hidden';a.style.visibility='hidden';}}},handleChange:function(event){var a=event.getTarget();this.updateFormElement(a);this.renderExample();},getName:function(a){return a.name||a.getAttribute('data-name');},handleSelectorChange:function(a){this.updateFormElement(a.selector);if(this.getName(a.selector)!='pageselector')this.renderExample();},updateFormElement:function(a){var b=this.getName(a),c=this.config.params[b];if(c.type=='bool'){c.value=a.checked?'true':'false';}else if(c.type=='enum'||c.type=='pageselector'){var d=Selector.getValue(a);if(!!a.getAttribute('data-multiple')){d=d.filter(function(f){return f.length>0;});d=d.join(',');}c.value=d;}else c.value=a.value;var e=c.value;if(c.type=='poll'){e=this.handlePollValueChange(b);b=c.pollName;}query_data={};query_data[b]=e;code_uri=URI(this.config.code_button.href);code_uri.addQueryData(query_data);this.config.code_button.href=code_uri.toString();},handlePollValueChange:function(a){var b=this.config.params[a],c=b.pollName,d=[];for(var e=0;e<this.config.params[c].questionsCount;e++){var f=this.config.params[c+'poll'+e].value;if(f!=='')d.push(f);}return FB.JSON.stringify(d);}});PluginConfigurator.initSelect=function(a,b){var c=DOM.scry(a,'.uiPillButton');c.forEach(function(d){Event.listen(d,'click',function(event){c.forEach(function(e){CSS.removeClass(e,'uiPillButtonSelected');});CSS.addClass(d,'uiPillButtonSelected');b.show(d.id.replace('button','snip'));});});};PluginConfigurator.initAppChooser=function(a){Selector.listen(a,'change',function(b){var c=Selector.getValue(a);['snip-html5','snip-xfbml','snip-iframe','snip-url'].forEach(function(d){var e=DOM.scry($(d),'textarea');if(e.length>0)DOM.setContent(e[0],DOM.getText(e[0]).replace(/appId=\d+/,'appId='+c));var f=DOM.scry($(d),'.uiSelector');if(f.length>0)Selector.setSelected(f[0],c);});});};
__d("legacy:template",["TemplateRegistrar","TemplateRegistry","Template"],function(a,b,c,d){var e=b('TemplateRegistrar'),f=b('TemplateRegistry');f.registerServerSideTemplate=e.registerServerSideTemplate;a.Template=b('Template');},3);